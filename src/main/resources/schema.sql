CREATE TABLE next_step_user
(
    id         BIGINT GENERATED BY DEFAULT AS IDENTITY,
    user_id    VARCHAR(20) NOT NULL,
    password   VARCHAR(20) NOT NULL,
    name       VARCHAR(20) NOT NULL,
    email      VARCHAR(50),
    created_at TIMESTAMP   NOT NULL,
    updated_at TIMESTAMP   NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE course
(
    id         BIGINT GENERATED BY DEFAULT AS IDENTITY,
    title      VARCHAR(255) NOT NULL,
    creator_id BIGINT       NOT NULL,
    created_at TIMESTAMP    NOT NULL,
    updated_at TIMESTAMP    NOT NULL,
    PRIMARY KEY (id),
    FOREIGN KEY (creator_id) REFERENCES next_step_user (id)
);

CREATE TABLE image
(
    id         BIGINT GENERATED BY DEFAULT AS IDENTITY,
    name       VARCHAR(255) NOT NULL,
    url        VARCHAR(255) NOT NULL,
    size       BIGINT       NOT NULL,
    type       VARCHAR(10)  NOT NULL,
    created_at TIMESTAMP    NOT NULL,
    updated_at TIMESTAMP    NOT NULL,
    PRIMARY KEY (id)
);


CREATE TABLE session_time
(
    id                BIGINT GENERATED BY DEFAULT AS IDENTITY,
    opening_date_time TIMESTAMP NOT NULL,
    closing_date_time TIMESTAMP NOT NULL,
    created_at        TIMESTAMP NOT NULL,
    updated_at        TIMESTAMP NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE enrollment
(
    id         BIGINT GENERATED BY DEFAULT AS IDENTITY,
    user_id    BIGINT    NOT NULL,
    session_id BIGINT    NOT NULL,
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP NOT NULL,
    PRIMARY KEY (id),
    FOREIGN KEY (user_id) REFERENCES next_step_user (id)
);

CREATE TABLE session
(
    id                 BIGINT GENERATED BY DEFAULT AS IDENTITY,
    period VARCHAR (255),
    cover_image_id     BIGINT,
    session_time_id    BIGINT,
    session_type       VARCHAR(255),
    session_status     VARCHAR(255),
    enrollment_id      BIGINT,
    course_id          BIGINT,
    maximum_enrollment INT,
    created_at         TIMESTAMP NOT NULL,
    updated_at         TIMESTAMP NOT NULL,
    PRIMARY KEY (id),
    FOREIGN KEY (cover_image_id) REFERENCES image (id),
    FOREIGN KEY (session_time_id) REFERENCES session_time (id),
    FOREIGN KEY (enrollment_id) REFERENCES enrollment (id),
    FOREIGN KEY (course_id) REFERENCES course (id)
);


CREATE TABLE question
(
    id         BIGINT GENERATED BY DEFAULT AS IDENTITY,
    created_at TIMESTAMP    NOT NULL,
    updated_at TIMESTAMP    NOT NULL,
    contents CLOB,
    deleted    BOOLEAN      NOT NULL,
    title      VARCHAR(100) NOT NULL,
    writer_id  BIGINT,
    PRIMARY KEY (id),
    FOREIGN KEY (writer_id) REFERENCES next_step_user (id)
);

CREATE TABLE answer
(
    id          BIGINT GENERATED BY DEFAULT AS IDENTITY,
    created_at  TIMESTAMP NOT NULL,
    updated_at  TIMESTAMP NOT NULL,
    contents CLOB,
    deleted     BOOLEAN   NOT NULL,
    question_id BIGINT,
    writer_id   BIGINT,
    PRIMARY KEY (id),
    FOREIGN KEY (question_id) REFERENCES question (id),
    FOREIGN KEY (writer_id) REFERENCES next_step_user (id)
);

CREATE TABLE delete_history
(
    id            BIGINT NOT NULL,
    content_id    BIGINT,
    content_type  VARCHAR(255),
    created_date  TIMESTAMP,
    deleted_by_id BIGINT,
    PRIMARY KEY (id),
    FOREIGN KEY (deleted_by_id) REFERENCES next_step_user (id)
);
